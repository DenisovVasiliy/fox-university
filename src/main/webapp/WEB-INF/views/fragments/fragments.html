<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head th:fragment="header (title)">
    <meta charset="UTF-8">
    <title th:text="${title}"></title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
</head>
<body>

<div th:fragment="menu">
    <nav class="navbar navbar-expand-lg navbar-light" style="background-color: #ffc966;">
        <a class="navbar-brand" href="/foxUniversity/">Fox-University</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="/foxUniversity/">Home <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/foxUniversity/courses/">Courses</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/foxUniversity/groups/">Groups</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/foxUniversity/students/">Students</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/foxUniversity/teachers/">Teachers</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="/foxUniversity/timetable/"
                       id="LessonsDropdown" role="button" data-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">
                        Lessons
                    </a>
                    <div class="dropdown-menu" aria-labelledby="LessonsDropdown">
                        <a class="dropdown-item" href="/foxUniversity/lessons/">All lessons</a>
                        <a class="dropdown-item" href="/foxUniversity/courses/">By course</a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle disabled" href="/foxUniversity/timetable/"
                       id="TimetableDropdown" role="button" data-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">
                        Timetable
                    </a>
                    <div class="dropdown-menu" aria-labelledby="TimetableDropdown">
                        <a class="dropdown-item" href="/foxUniversity/timetable/">Teacher's</a>
                        <a class="dropdown-item" href="/foxUniversity/timetable/">Student's</a>
                    </div>
                </li>
            </ul>
            <span class="navbar-text">
        "From Fox with love"
        </span>
        </div>
    </nav>
</div>

<div th:fragment="courses">
    <h4>Courses:</h4>
    <table class="table table-striped">
        <tbody>
        <tr th:each="course: ${courses}">
            <td>
                <a th:href="@{/courses/info/(id=${course.id})}" th:text="${course.name}"></a>
            </td>
            <td>
                <div class="text-right">
                    <a class="btn btn-secondary"
                       th:href="@{/lessons/by-course/(courseId=${course.id})}" role="button">Show course's lessons</a>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div th:fragment="course-info">
    <h4 th:text="${course.name}"></h4>
    <p th:text="${course.description}"></p>
    <table class="table table-striped">
        <thead>
        <tr>
            <th scope="col">Our teachers:</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="teacher: ${teachers}">
            <td>
                <a th:href="@{/teachers/info/(id=${teacher.id})}"
                   th:text="|${teacher.firstName} ${teacher.lastName}|"></a>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div th:fragment="teachers">
    <table class="table table-striped">
        <thead>
        <tr>
            <th scope="col">Teacher</th>
            <th scope="col">Course</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="teacher: ${teachers}">
            <td>
                <a th:href="@{/teachers/info/(id=${teacher.id})}"
                   th:text="| ${teacher.firstName} ${teacher.lastName} |"></a>
            </td>
            <td>
                <a th:href="@{/courses/info/(id=${teacher.course.id})}" th:text="| ${teacher.course.name} |"></a>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div th:fragment="teacher-info">
    <table class="table table-striped">
        <thead>
        <th colspan="2">
            <h4 class="text-center mb-0">here will be buttons</h4>
        </th>
        </thead>
        <tbody>
        <tr>
            <th scope="col">Name</th>
            <td>
                <p class="mb-0" th:text="${teacher.firstName}"></p>
            </td>
        </tr>
        <tr>
            <th scope="col">Surname</th>
            <td>
                <p class="mb-0" th:text="${teacher.lastName}"></p>
            </td>
        </tr>
        <tr>
            <th scope="col">Course</th>
            <td>
                <a th:href="@{/courses/info/(id=${teacher.course.id})}" th:text="${teacher.course.name}"></a>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div th:fragment="groups">
    <table class="table table-striped">
        <thead>
        <th>
            <h4 class="mb-0">Groups:</h4>
        </th>
        </thead>
        <tbody>
        <tr th:each="group: ${groups}">
            <td>
                <a th:href="@{/groups/info/(id=${group.id})}" th:text="${group.name}"></a>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div th:fragment="group-info">
    <h4 th:text="|Group ${group.name}|"></h4>
    <div class="container">
        <div class="row">
            <div class="col">
                <h5>Group's courses:</h5>
                <table class="table table-striped">
                    <tbody>
                    <tr th:each="course: ${courses}">
                        <td>
                            <a th:href="@{/courses/info/(id=${course.id})}" th:text="${course.name}"></a>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="col">
                <h5>Group's students:</h5>
                <table class="table table-striped">
                    <tbody>
                    <tr th:each="student: ${group.students}">
                        <td>
                            <a th:href="@{/students/info/(id=${student.id})}"
                               th:text="| ${student.firstName} ${student.lastName} |"></a>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div th:fragment="students">
    <table class="table table-striped">
        <thead>
        <tr>
            <th scope="col">Student</th>
            <th scope="col">Group</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="student: ${students}">
            <td>
                <a th:href="@{/students/info/(id=${student.id})}"
                   th:text="| ${student.firstName} ${student.lastName} |"></a>
            </td>
            <td th:unless="${student.group}==null">
                <a th:href="@{/groups/info/(id=${student.group.id})}" th:text="| ${student.group.name} |"></a>
            </td>
            <td th:if="${student.group}==null">
                Not assigned
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div th:fragment="student-info">
    <table class="table table-striped">
        <thead>
        <th class="text-center" colspan="2">
            <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#editModal">Edit
            </button>
            <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#deleteStudent">Delete</button>
            <span th:unless="${student.group}==null">
                <a role="button" class="btn btn-warning"
                   th:href="@{/students/assign/(id=${student.id})}">Change group</a>
                <button type="button" class="btn btn-danger" data-toggle="modal"
                        data-target="#deleteStudentGroup">Delete group</button>
                <div th:replace="fragments/fragments :: delete-students-group"></div>
            </span>
        </th>
        </thead>
        <tbody>
        <tr>
            <th scope="col">Name</th>
            <td>
                <p class="mb-0" th:text="${student.firstName}"></p>
            </td>
        </tr>
        <tr>
            <th scope="col">Surname</th>
            <td>
                <p class="mb-0" th:text="${student.lastName}"></p>
            </td>
        </tr>
        <tr>
            <th scope="row">Group</th>
            <td>
                <a th:unless="${student.group}==null" class="btn btn-outline-info"
                   th:href="@{/groups/info/(id=${student.group.id})}" th:text="${student.group.name}" role="button"></a>
                <a th:if="${student.group}==null" role="button" class="btn btn-success"
                   th:href="@{/students/assign/(id=${student.id})}">Assign</a>
            </td>
        </tr>
        </tbody>
    </table>
    <div th:replace="fragments/fragments :: edit-student"></div>
    <div th:replace="fragments/fragments :: delete-student"></div>
</div>

<div th:fragment="edit-student">
    <div class="modal fade" id="editModal" data-backdrop="static" tabindex="-1" role="dialog"
         aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="staticBackdropLabel">Edit student</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form th:action="@{/students/edit/(id=${student.id})}" th:object="${editStudent}" method="POST">
                        <div class="form-group row">
                            <label for="id" class="col-sm-2 col-form-label">ID:</label>
                            <div class="col-sm-10">
                                <input type="text" readonly class="form-control-plaintext" id="id" th:field="*{id}"
                                       th:value="${student.id}">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="inputName" class="col-sm-2 col-form-label">Name:</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="inputName" th:field="*{firstName}"
                                       th:value="${student.firstName}" required>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="inputLastName" class="col-sm-2 col-form-label">Surname:</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="inputLastName" th:field="*{lastName}"
                                       th:value="${student.lastName}" required>
                            </div>
                        </div>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<div th:fragment="assign-student">
    <form th:action="@{/students/assign/(studentId=${student.id})}" th:object="${newGroup}" method="POST">
        <div class="form-group row">
            <h5 class="text-center" id="assignStudentLabel">Assign student</h5>
        </div>
        <div class="form-group row">
            <label for="id1" class="col-sm-2 col-form-label">ID:</label>
            <div class="col-sm-10">
                <input type="text" readonly class="form-control-plaintext" id="id1"
                       th:value="${student.id}">
            </div>
        </div>
        <div class="form-group row">
            <label for="studentName" class="col-sm-2 col-form-label">Name:</label>
            <div class="col-sm-10">
                <input type="text" readonly class="form-control" id="studentName" th:value="${student.firstName}">
            </div>
        </div>
        <div class="form-group row">
            <label for="studentLastName" class="col-sm-2 col-form-label">Surname:</label>
            <div class="col-sm-10">
                <input type="text" readonly class="form-control" id="studentLastName" th:value="${student.lastName}">
            </div>
        </div>
        <div class="form-group row">
            <label for="selectGroup" class="col-sm-2 col-form-label">Group:</label>
            <div class="col-sm-10">
                <select class="form-control" id="selectGroup" name="id" required>
                    <option value="" disabled th:selected="${student.group==null}">
                        Choose group
                    </option>
                    <option th:each="group: ${groups}" th:value="${group.id}"
                            th:text="${group.name}"
                            th:selected="${student.group!=null} and ${student.group.id==group.id}">Group
                    </option>
                </select>
            </div>
        </div>
        <a href="#" role="button" class="btn btn-outline-danger" onclick="history.back();">Cancel</a>
        <button type="submit" class="btn btn-primary">Assign</button>
    </form>
</div>

<div th:fragment="modal-student-description">
    <div class="form-group row">
        <label for="studentId" class="col-sm-2 col-form-label">ID:</label>
        <div class="col-sm-10">
            <input type="text" readonly class="form-control-plaintext" id="studentId" th:field="*{id}"
                   th:value="${student.id}">
        </div>
    </div>
    <div class="form-group row">
        <label for="studentNameRead" class="col-sm-2 col-form-label">Name:</label>
        <div class="col-sm-10">
            <input type="text" readonly class="form-control-plaintext" id="studentNameRead" th:field="*{firstName}"
                   th:value="${student.firstName}">
        </div>
    </div>
    <div class="form-group row">
        <label for="studentLastNameRead" class="col-sm-2 col-form-label">Surname:</label>
        <div class="col-sm-10">
            <input type="text" readonly class="form-control-plaintext" id="studentLastNameRead" th:field="*{lastName}"
                   th:value="${student.lastName}">
        </div>
    </div>
    <div class="form-group row">
        <label for="studentGroupRead" class="col-sm-2 col-form-label">Group:</label>
        <div class="col-sm-10">
            <input type="text" readonly class="form-control-plaintext" id="studentGroupRead"
                   th:value="${student.group==null} ? 'Not assigned' : ${student.group.name}">
        </div>
    </div>
</div>

<div th:fragment="delete-student">
    <div class="modal fade" id="deleteStudent" data-backdrop="static" tabindex="-1" role="dialog"
         aria-labelledby="deleteStudentsGroupLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteStudentLabel">
                        Confirm removing the student
                    </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form th:action="@{/students/delete/(id=${student.id})}"
                          th:object="${editStudent}" method="POST">
                        <div th:replace="fragments/fragments :: modal-student-description"></div>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-danger">Delete</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<div th:fragment="delete-students-group">
    <div class="modal fade" id="deleteStudentGroup" data-backdrop="static" tabindex="-1" role="dialog"
         aria-labelledby="deleteStudentsGroupLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteStudentsGroupLabel">
                        Confirm removing the student from the group
                    </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form th:action="@{/students/delete-from-group/}"
                          th:object="${editStudent}" method="POST">
                        <div th:replace="fragments/fragments :: modal-student-description"></div>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-danger">Delete from group</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<div th:fragment="lessons">
    <table class="table table-striped">
        <thead>
        <tr>
            <th scope="col">Day</th>
            <th scope="col">Time</th>
            <th scope="col">Class #</th>
            <th scope="col">Course</th>
            <th scope="col">Teacher</th>
            <th scope="col"></th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="lesson: ${lessons}">
            <td>
                <p th:text="${lesson.day}"></p>
            </td>
            <td>
                <p th:text="${lesson.startTime}"></p>
            </td>
            <td>
                <p th:text="${lesson.classroom}"></p>
            </td>
            <td>
                <a th:href="@{/courses/info/(id=${lesson.course.id})}"
                   th:text="| ${lesson.course.name} |"></a>
                <p class="mb-0" th:text="|(${lesson.type})|"></p>
            </td>
            <td>
                <a th:href="@{/teachers/info/(id=${lesson.teacher.id})}"
                   th:text="| ${lesson.teacher.firstName} ${lesson.teacher.lastName} |"></a>
            </td>
            <td>
                <a class="btn btn-outline-info"
                   th:href="@{/lessons/info/(id=${lesson.id})}" role="button">Info</a>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div th:fragment="lesson-info">
    <table class="table table-striped">
        <thead>
        <th colspan="2">
            <h4 class="text-center mb-0">Info</h4>
        </th>
        </thead>
        <tbody>
        <tr>
            <th scope="col">Day</th>
            <td>
                <p class="mb-0" th:text="${lesson.day}"></p>
            </td>
        </tr>
        <tr>
            <th scope="col">Time</th>
            <td>
                <p class="mb-0" th:text="${lesson.startTime}"></p>
            </td>
        </tr>
        <tr>
            <th scope="col">Class #</th>
            <td>
                <p class="mb-0" th:text="${lesson.classroom}"></p>
            </td>
        </tr>
        <tr>
            <th scope="col">Course</th>
            <td>
                <a th:href="@{/courses/info/(id=${lesson.course.id})}"
                   th:text="| ${lesson.course.name} |"></a>
            </td>
        </tr>
        <tr>
            <th scope="col">Lesson's type</th>
            <td>
                <p class="mb-0" th:text="|${lesson.type}|"></p>
            </td>
        </tr>
        <tr>
            <th scope="col">Teacher</th>
            <td>
                <a th:href="@{/teachers/info/(id=${lesson.teacher.id})}"
                   th:text="| ${lesson.teacher.firstName} ${lesson.teacher.lastName} |"></a>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div th:fragment="notification">
    <div th:unless="${warnMessage==null}">
        <div class="alert alert-warning" role="alert">
            <p class="text-center mb-0" th:text="${warnMessage}">Sorry, page not found...</p>
        </div>
    </div>
    <div th:unless="${errorMessage==null}">
        <div class="alert alert-danger" role="alert">
            <p class="text-center mb-0" th:text="${errorMessage}">Sorry, something went wrong...</p>
        </div>
    </div>
</div>

</body>
</html>